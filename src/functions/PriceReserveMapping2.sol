// SPDX-License-Identifier: MIT

pragma solidity ^0.8.20;

/**
 * @title PriceReserveMapping
 * @author DeadmanWalking
 * @notice The `Stable2` Well Function implementation of
 * `calcReserveAtRatioSwap` and `calcReserveAtRatioLiquidity` requires
 * multiple calculations of the price given a change in reserves.
 * Performing the calculation on-chain is expensive, and thus a LUT is implemented
 * to decrease the computation done on execution.
 *
 * @dev given `price`, returns the ratio of reserves needed for the pool to return
 * `price` when calling `calcRate`, scaled to 100e18.
 * Example:
 * p = 1.011271030257560703e18,
 * r = 698337_296093749599797248
 * reserve[0] = 1_000_000e6
 * reserve[1] = 698337_296093
 */
contract PriceReserveMapping {
    function getReserve(uint256 price) external pure returns (uint256) {
        if (price < 1.000033716578442112e18) {
            if (price < 830_357_766_063_866_624) {
                if (price < 608_750_007_429_268_480) {
                    if (price < 497_147_688_282_685_696) {
                        if (price < 441_195_594_527_224_000) {
                            if (price < 421_290_035_178_414_208) {
                                if (price < 404_517_292_279_625_088) {
                                    return 7_039_988_712_124_655_530_409_984;
                                } else {
                                    return 7_039_988_712_124_655_530_409_984;
                                }
                            } else {
                                if (price < 422_561_897_881_033_792) {
                                    return 6_704_751_154_404_433_787_355_136;
                                } else {
                                    return 6_704_751_154_404_433_787_355_136;
                                }
                            }
                        } else {
                            if (price < 460_406_209_346_677_952) {
                                if (price < 458_149_633_111_917_824) {
                                    return 6_115_909_044_841_460_461_993_984;
                                } else {
                                    return 6_115_909_044_841_460_461_993_984;
                                }
                            } else {
                                if (price < 480_176_259_556_639_872) {
                                    return 5_791_816_135_971_867_467_972_608;
                                } else {
                                    return 5_791_816_135_971_867_467_972_608;
                                }
                            }
                        }
                    } else {
                        if (price < 542_576_156_450_906_944) {
                            if (price < 521_294_640_197_852_672) {
                                if (price < 500_482_361_488_375_424) {
                                    return 5_516_015_367_592_254_935_924_736;
                                } else {
                                    return 5_516_015_367_592_254_935_924_736;
                                }
                            } else {
                                if (price < 538_091_395_837_277_056) {
                                    return 5_054_470_284_992_941_802_913_792;
                                } else {
                                    return 5_054_470_284_992_941_802_913_792;
                                }
                            }
                        } else {
                            if (price < 580_686_644_101_094_656) {
                                if (price < 564_282_371_756_721_024) {
                                    return 4_764_941_468_603_609_620_938_752;
                                } else {
                                    return 4_764_941_468_603_609_620_938_752;
                                }
                            } else {
                                if (price < 586_360_676_154_978_944) {
                                    return 4_538_039_493_908_200_048_033_792;
                                } else {
                                    return 4_538_039_493_908_200_048_033_792;
                                }
                            }
                        }
                    }
                } else {
                    if (price < 722_615_518_283_425_408) {
                        if (price < 669_067_822_553_920_512) {
                            if (price < 631_380_594_036_478_848) {
                                if (price < 624_523_709_284_514_688) {
                                    return 4_177_248_169_415_654_040_928_256;
                                } else {
                                    return 4_177_248_169_415_654_040_928_256;
                                }
                            } else {
                                if (price < 654_173_856_946_462_592) {
                                    return 3_920_129_138_458_653_678_895_104;
                                } else {
                                    return 3_920_129_138_458_653_678_895_104;
                                }
                            }
                        } else {
                            if (price < 699_890_877_274_508_032) {
                                if (price < 677_042_507_344_532_224) {
                                    return 3_733_456_322_341_575_008_976_896;
                                } else {
                                    return 3_733_456_322_341_575_008_976_896;
                                }
                            } else {
                                if (price < 713_658_133_485_124_864) {
                                    return 3_452_271_214_393_102_144_897_024;
                                } else {
                                    return 3_452_271_214_393_102_144_897_024;
                                }
                            }
                        }
                    } else {
                        if (price < 788_916_974_369_642_752) {
                            if (price < 757_518_945_604_179_584) {
                                if (price < 745_106_098_488_377_088) {
                                    return 3_225_099_943_713_702_223_544_320;
                                } else {
                                    return 3_225_099_943_713_702_223_544_320;
                                }
                            } else {
                                if (price < 767_246_620_828_971_264) {
                                    return 3_071_523_755_917_812_229_472_256;
                                } else {
                                    return 3_071_523_755_917_812_229_472_256;
                                }
                            }
                        } else {
                            if (price < 809_994_816_396_841_728) {
                                if (price < 799_786_725_808_037_248) {
                                    return 2_853_116_706_110_001_328_947_200;
                                } else {
                                    return 2_853_116_706_110_001_328_947_200;
                                }
                            } else {
                                return 2_785_962_590_401_643_029_725_184;
                            }
                        }
                    }
                }
            } else {
                if (price < 972_989_115_515_289_216) {
                    if (price < 917_489_006_622_623_232) {
                        if (price < 875_936_112_087_689_344) {
                            if (price < 849_885_871_198_024_448) {
                                if (price < 839_554_943_435_977_728) {
                                    return 2_593_742_460_100_001_012_908_032;
                                } else {
                                    return 2_593_742_460_100_001_012_908_032;
                                }
                            } else {
                                if (price < 868_464_289_727_404_288) {
                                    return 2_406_619_233_691_085_014_302_720;
                                } else {
                                    return 2_406_619_233_691_085_014_302_720;
                                }
                            }
                        } else {
                            if (price < 902_355_196_812_224_000) {
                                if (price < 885_986_107_499_586_304) {
                                    return 2_292_018_317_801_032_886_779_904;
                                } else {
                                    return 2_292_018_317_801_032_886_779_904;
                                }
                            } else {
                                if (price < 908_136_713_928_969_216) {
                                    return 2_143_588_810_000_000_484_376_576;
                                } else {
                                    return 2_143_588_810_000_000_484_376_576;
                                }
                            }
                        }
                    } else {
                        if (price < 954_909_391_012_556_032) {
                            if (price < 935_536_737_788_984_832) {
                                if (price < 931_321_167_909_476_608) {
                                    return 1_979_931_599_439_397_501_534_208;
                                } else {
                                    return 1_979_931_599_439_397_501_534_208;
                                }
                            } else {
                                if (price < 943_803_797_433_811_072) {
                                    return 1_885_649_142_323_235_971_399_680;
                                } else {
                                    return 1_885_649_142_323_235_971_399_680;
                                }
                            }
                        } else {
                            if (price < 964_632_213_434_632_832) {
                                if (price < 957_762_568_730_056_576) {
                                    return 1_771_561_000_000_000_284_950_528;
                                } else {
                                    return 1_771_561_000_000_000_284_950_528;
                                }
                            } else {
                                return 1_710_339_358_116_313_758_171_136;
                            }
                        }
                    }
                } else {
                    if (price < 996_430_298_345_225_728) {
                        if (price < 986_726_125_054_516_224) {
                            if (price < 980_019_737_867_874_432) {
                                if (price < 974_741_215_197_397_632) {
                                    return 1_610_510_000_000_000_210_239_488;
                                } else {
                                    return 1_610_510_000_000_000_210_239_488;
                                }
                            } else {
                                if (price < 985_786_093_464_194_432) {
                                    return 1_477_455_443_789_062_678_249_472;
                                } else {
                                    return 1_477_455_443_789_062_678_249_472;
                                }
                            }
                        } else {
                            if (price < 993_879_297_978_292_480) {
                                if (price < 990_371_554_230_599_424) {
                                    return 1_407_100_422_656_250_003_587_072;
                                } else {
                                    return 1_407_100_422_656_250_003_587_072;
                                }
                            } else {
                                if (price < 994_289_877_233_378_560) {
                                    return 1_331_000_000_000_000_102_760_448;
                                } else {
                                    return 1_331_000_000_000_000_102_760_448;
                                }
                            }
                        }
                    } else {
                        if (price < 999_768_290_809_212_032) {
                            if (price < 998_285_495_618_766_464) {
                                if (price < 998_160_960_147_888_768) {
                                    return 1_215_506_250_000_000_018_808_832;
                                } else {
                                    return 1_215_506_250_000_000_018_808_832;
                                }
                            } else {
                                if (price < 999_220_514_391_006_208) {
                                    return 1_157_625_000_000_000_062_652_416;
                                } else {
                                    return 1_157_625_000_000_000_062_652_416;
                                }
                            }
                        } else {
                            if (price < 999_970_981_689_446_016) {
                                if (price < 999_784_063_917_080_448) {
                                    return 1_099_999_999_999_999_874_170_880;
                                } else {
                                    return 1_099_999_999_999_999_874_170_880;
                                }
                            } else {
                                return 1_050_000_000_000_000_062_914_560;
                            }
                        }
                    }
                }
            }
        } else {
            if (price < 1_270_229_006_927_506_432) {
                if (price < 1_042_410_779_328_363_904) {
                    if (price < 1_007_730_870_339_573_120) {
                        if (price < 1_002_138_979_681_074_944) {
                            if (price < 1_000_291_630_212_889_856) {
                                if (price < 1_000_269_233_009_443_840) {
                                    return 902_500_000_000_000_015_728_640;
                                } else {
                                    return 902_500_000_000_000_015_728_640;
                                }
                            } else {
                                if (price < 1_000_905_972_187_880_320) {
                                    return 857_374_999_999_999_847_170_048;
                                } else {
                                    return 857_374_999_999_999_847_170_048;
                                }
                            }
                        } else {
                            if (price < 1_004_157_377_550_525_696) {
                                if (price < 1_002_316_102_194_843_648) {
                                    return 810_000_000_000_000_029_360_128;
                                } else {
                                    return 810_000_000_000_000_029_360_128;
                                }
                            } else {
                                if (price < 1_007_143_263_844_912_000) {
                                    return 735_091_890_624_999_614_054_400;
                                } else {
                                    return 735_091_890_624_999_614_054_400;
                                }
                            }
                        }
                    } else {
                        if (price < 1_023_609_741_631_299_072) {
                            if (price < 1_016_707_057_698_784_896) {
                                if (price < 1_011_271_030_257_560_704) {
                                    return 698_337_296_093_749_599_797_248;
                                } else {
                                    return 698_337_296_093_749_599_797_248;
                                }
                            } else {
                                if (price < 1_018_070_626_816_667_904) {
                                    return 656_100_000_000_000_049_283_072;
                                } else {
                                    return 656_100_000_000_000_049_283_072;
                                }
                            }
                        } else {
                            if (price < 1_034_730_220_540_242_944) {
                                if (price < 1_032_129_795_364_543_616) {
                                    return 598_736_939_238_378_581_262_336;
                                } else {
                                    return 598_736_939_238_378_581_262_336;
                                }
                            } else {
                                return 590_490_000_000_000_030_932_992;
                            }
                        }
                    }
                } else {
                    if (price < 1_134_730_371_284_194_048) {
                        if (price < 1_085_163_323_283_893_760) {
                            if (price < 1_058_971_528_414_115_200) {
                                if (price < 1_054_589_806_813_510_272) {
                                    return 540_360_087_662_636_587_548_672;
                                } else {
                                    return 540_360_087_662_636_587_548_672;
                                }
                            } else {
                                if (price < 1_068_798_380_970_533_888) {
                                    return 513_342_083_279_504_818_569_216;
                                } else {
                                    return 513_342_083_279_504_818_569_216;
                                }
                            }
                        } else {
                            if (price < 1_103_807_759_690_609_920) {
                                if (price < 1_091_946_638_369_647_232) {
                                    return 478_296_900_000_000_063_307_776;
                                } else {
                                    return 478_296_900_000_000_063_307_776;
                                }
                            } else {
                                if (price < 1_124_852_136_531_598_848) {
                                    return 440_126_668_651_765_310_685_184;
                                } else {
                                    return 440_126_668_651_765_310_685_184;
                                }
                            }
                        }
                    } else {
                        if (price < 1_203_570_602_035_602_432) {
                            if (price < 1_174_615_232_221_620_736) {
                                if (price < 1_148_415_244_275_700_096) {
                                    return 418_120_335_219_177_014_951_936;
                                } else {
                                    return 418_120_335_219_177_014_951_936;
                                }
                            } else {
                                if (price < 1_188_356_761_339_094_272) {
                                    return 387_420_489_000_000_082_149_376;
                                } else {
                                    return 387_420_489_000_000_082_149_376;
                                }
                            }
                        } else {
                            if (price < 1_253_855_901_740_080_128) {
                                if (price < 1_235_401_171_969_669_632) {
                                    return 358_485_922_408_541_800_366_080;
                                } else {
                                    return 358_485_922_408_541_800_366_080;
                                }
                            } else {
                                return 348_678_440_100_000_100_777_984;
                            }
                        }
                    }
                }
            } else {
                if (price < 1_813_506_410_438_685_184) {
                    if (price < 1_532_552_739_400_572_928) {
                        if (price < 1_393_968_967_516_634_880) {
                            if (price < 1_332_289_125_721_440_768) {
                                if (price < 1_308_179_312_239_340_544) {
                                    return 323_533_544_973_709_000_835_072;
                                } else {
                                    return 323_533_544_973_709_000_835_072;
                                }
                            } else {
                                if (price < 1_349_381_291_133_012_224) {
                                    return 307_356_867_725_023_544_082_432;
                                } else {
                                    return 307_356_867_725_023_544_082_432;
                                }
                            }
                        } else {
                            if (price < 1_442_081_976_893_328_640) {
                                if (price < 1_424_781_668_356_408_832) {
                                    return 282_429_536_481_000_091_025_408;
                                } else {
                                    return 282_429_536_481_000_091_025_408;
                                }
                            } else {
                                if (price < 1_493_866_329_083_113_216) {
                                    return 263_520_094_465_741_985_677_312;
                                } else {
                                    return 263_520_094_465_741_985_677_312;
                                }
                            }
                        }
                    } else {
                        if (price < 1_672_818_539_081_097_216) {
                            if (price < 1_609_069_386_068_001_536) {
                                if (price < 1_549_475_146_998_422_528) {
                                    return 250_344_089_742_454_896_459_776;
                                } else {
                                    return 250_344_089_742_454_896_459_776;
                                }
                            } else {
                                if (price < 1_656_943_402_509_807_872) {
                                    return 228_767_924_549_610_094_198_784;
                                } else {
                                    return 228_767_924_549_610_094_198_784;
                                }
                            }
                        } else {
                            if (price < 1_799_442_892_480_155_648) {
                                if (price < 1_740_901_331_273_835_008) {
                                    return 214_638_763_942_937_209_339_904;
                                } else {
                                    return 214_638_763_942_937_209_339_904;
                                }
                            } else {
                                return 205_891_132_094_649_074_712_576;
                            }
                        }
                    }
                } else {
                    if (price < 2_353_244_129_099_838_464) {
                        if (price < 2_060_505_206_109_642_752) {
                            if (price < 1_961_714_091_549_304_320) {
                                if (price < 1_890_833_036_735_312_384) {
                                    return 193_711_484_458_500_800_643_072;
                                } else {
                                    return 193_711_484_458_500_800_643_072;
                                }
                            } else {
                                if (price < 1_973_091_776_740_027_136) {
                                    return 184_025_910_235_575_711_956_992;
                                } else {
                                    return 184_025_910_235_575_711_956_992;
                                }
                            }
                        } else {
                            if (price < 2_153_308_625_067_387_136) {
                                if (price < 2_145_618_891_058_364_672) {
                                    return 166_771_816_996_665_772_998_656;
                                } else {
                                    return 166_771_816_996_665_772_998_656;
                                }
                            } else {
                                if (price < 2_251_750_790_753_840_896) {
                                    return 157_779_214_788_226_736_717_824;
                                } else {
                                    return 157_779_214_788_226_736_717_824;
                                }
                            }
                        }
                    } else {
                        if (price < 2_586_928_745_378_339_328) {
                            if (price < 2_466_618_218_597_512_192) {
                                if (price < 2_356_094_670_332_007_936) {
                                    return 149_890_254_048_815_394_848_768;
                                } else {
                                    return 149_890_254_048_815_394_848_768;
                                }
                            } else {
                                if (price < 2_583_615_183_726_152_192) {
                                    return 135_275_954_279_055_877_996_544;
                                } else {
                                    return 135_275_954_279_055_877_996_544;
                                }
                            }
                        } else {
                            if (price < 2_849_292_747_060_493_824) {
                                if (price < 2_707_395_944_693_278_720) {
                                    return 128_512_156_565_103_074_869_248;
                                } else {
                                    return 128_512_156_565_103_074_869_248;
                                }
                            } else {
                                return 121_576_654_590_569_365_897_216;
                            }
                        }
                    }
                }
            }
        }
    }
}
